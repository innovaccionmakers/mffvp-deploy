[
  {
    "WorkflowName": "Closing.ProfitLoss.UploadValidationV2",
    "Rules": [
      {
        "RuleName": "AllConceptsExist",
        "ErrorMessage": "No existen algunos de los conceptos solicitados",
        "Expression": "input.RequestedConceptNames.Length == input.Concepts.Length",
        "Properties": {
          "errorCode": "a1b2c3d4-e5f6-7890-abcd-ef1234567890",
          "internalCode": "CLOSING_000"
        }
      },
      {
        "RuleName": "NoFutureDate",
        "ErrorMessage": "La fecha de proceso no puede ser mayor a la fecha actual",
        "Expression": "input.EffectiveDate <= DateTime.UtcNow.Date",
        "Properties": {
          "errorCode": "5063eccb-3107-47a0-8eef-a9775c5c33a6",
          "internalCode": "CLOSING_001"
        }
      },
      {
        "RuleName": "NegativesOnlyIfAllowed",
        "ErrorMessage": "Existen montos negativos en conceptos que no lo permiten",
        "Expression": "input.Concepts.All(c => c.AllowNegative == true || c.Amount >= 0)",
        "Properties": {
          "errorCode": "d14d6a61-3fe6-4c07-9f04-35c50a6481d3",
          "internalCode": "CLOSING_002"
        }
      },
      {
        "RuleName": "AtLeastOneConcept",
        "ErrorMessage": "Debe existir al menos un concepto",
        "Expression": "input.Concepts.Any()",
        "Properties": {
          "errorCode": "07075653-c27f-484a-8c93-efb1438e4b6b",
          "internalCode": "CLOSING_003"
        }
      },
      {
        "RuleName": "EffectiveDateMustBeNextDay",
        "ErrorMessage": "La fecha efectiva debe ser exactamente un día después de la fecha actual del portafolio",
        "Expression": "input.EffectiveDate.Date == input.PortfolioCurrentDate.Date.AddDays(1)",
        "Properties": {
          "errorCode": "2b8c9e1f-4a7d-6b3e-8c5f-9d2e7a4b8c6f",
          "internalCode": "CLOSING_005"
        }
      }
    ]
  },
  {
    "WorkflowName": "Closing.Preclosing.Simulation.BlockingValidations",
    "Rules": [
      {
        "RuleName": "ClosingDate_OneDayAfterCurrentDate",
        "ErrorMessage": "La fecha de cierre debe ser un día después de la fecha actual del portafolio",
        "Expression": "input.ClosingDate.Date == input.CurrentDate.Date.AddDays(1)",
        "Properties": {
          "errorCode": ""
        }
      },
      {
        "RuleName": "FirstDay_NoPandL",
        "ErrorMessage": "No debe existir PYG en el primer día de cierre.",
        "Expression": "input.IsFirstClosingDay == true && input.ProfitAndLossExists == false",
        "Properties": {
          "errorCode": ""
        }
      },
      {
        "RuleName": "FirstDay_NoTreasuryMovements",
        "ErrorMessage": "No debe existir movimientos de tesorería en el primer día de cierre.",
        "Expression": "input.IsFirstClosingDay == true && input.TreasuryMovementsExists == false",
        "Properties": {
          "errorCode": ""
        }
      },
      {
        "RuleName": "FirstDay_MustHaveIncomeOperations",
        "ErrorMessage": "Deben existir operaciones de entrada en el primer día de cierre.",
        "Expression": "input.IsFirstClosingDay == true && HasClientOperations == true",
        "Properties": {
          "errorCode": ""
        }
      },
      {
        "RuleName": "Closing_MustHaveAdminCommission",
        "ErrorMessage": "Debe existir definida la Comisión Administrativa para el cierre.",
        "Expression": "input.AdminCommissionCount == 0",
        "Properties": {
          "errorCode": ""
        }
      },
      {
        "RuleName": "Closing_MustHaveOneAdminCommission",
        "ErrorMessage": "Debe existir definida sólo una Comisión Administrativa por Portafolio.",
        "Expression": "input.AdminCommissionCount > 1",
        "Properties": {
          "errorCode": ""
        }
      },
      {
        "RuleName": "AdminCommission_MustBeNumber",
        "ErrorMessage": "El valor de la Comisión Administrativa debe ser un número.",
        "Expression": "input.AdminCommissionIsNumber == false",
        "Properties": {
          "errorCode": ""
        }
      },
      {
        "RuleName": "AdminCommission_MustBe0And100",
        "ErrorMessage": "El valor de la Comisión Administrativa debe estar entre 0 y 100.",
        "Expression": "input.AdminCommissionBetween0And100 == false",
        "Properties": {
          "errorCode": ""
        }
      }
    ]
  }
]